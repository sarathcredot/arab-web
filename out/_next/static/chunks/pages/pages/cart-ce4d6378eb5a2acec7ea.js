(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9839],{4140:function(t,e,a){"use strict";a.r(e);var r=a(809),n=a.n(r),c=a(2447),l=a(6265),o=a(4121),s=a(7261),u=a(7294),i=a(1163),d=a(8216),p=a(8974),m=a(7029),f=a(2806),g=a(2821),b=a(1649),v=a(9710),h=a(1919),N=a(4931),y=a(2559),k=a(2132),x=a(4593),O=u.createElement;function C(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function S(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?C(Object(a),!0).forEach((function(e){(0,l.Z)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function P(){var t=(0,s.Z)(["\n  mutation RemoveFromCart($input: removeFromCartInput!) {\n    removeFromCart(input: $input) {\n      message\n    }\n  }\n"]);return P=function(){return t},t}function w(){var t=(0,s.Z)(["\n  mutation UpdateCartQuantity($input: updateCartQuantityInput!) {\n    updateCartQuantity(input: $input) {\n      message\n    }\n  }\n"]);return w=function(){return t},t}function I(){var t=(0,s.Z)(["\n  query GetCart {\n    getCart {\n      products {\n        _id\n        productId\n        quantity\n        name\n        shortDescription\n        stock\n        color\n        size\n        price\n        image\n        sellingPrice\n        mrp\n      }\n      grandTotal\n      subTotal\n      deliveryCharge\n    }\n  }\n"]);return I=function(){return t},t}var T=(0,v.Ps)(I()),Z=(0,v.Ps)(w()),j=(0,v.Ps)(P());e.default=(0,y.Z)({ssr:!1})((0,d.$j)((function(t){return{cart:t.cartlist.cart?t.cartlist.cart:[]}}),S({},f.Nw))((function(t){var e,a=(0,i.useRouter)(),r=(0,u.useState)([]),l=r[0],s=r[1],d=(0,u.useState)({grandTotal:0,subTotal:0,deliveryCharge:0}),f=d[0],v=d[1],y=(0,h.D)(Z),C=(0,o.Z)(y,1)[0],P=(0,h.D)(j),w=(0,o.Z)(P,1)[0],I=localStorage.getItem("arabtoken"),_=(0,u.useState)(JSON.parse(localStorage.getItem("cart"))||[]),F=_[0],q=(_[1],(0,u.useState)(!1)),E=q[0],D=q[1],R=(0,N.a)(T,{skip:!I}),Q=R.data,$=(R.loading,R.error),J=R.refetch;(0,u.useEffect)((function(){if(I){if($)console.error("Error fetching cart data:",$);else if(Q){var t=Q.getCart.products||[];s(t),v({grandTotal:Q.getCart.grandTotal,subTotal:Q.getCart.subTotal,deliveryCharge:Q.getCart.deliveryCharge})}J()}}),[I,Q,$,J]),(0,u.useEffect)((function(){if(!I&&F.length>0){s(F);var t=F.reduce((function(t,e){return t+e.sellingPrice*e.quantity}),0);v((function(e){return S(S({},e),{},{subTotal:t})}))}}),[I,F]);var M=function(){var t=(0,c.Z)(n().mark((function t(e){var a,r,c,l;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!I){t.next=7;break}return t.next=4,w({variables:{input:{productId:e}}});case 4:t.sent,J(),k.Am.success("Successfully removed product");case 7:I||null!==(a=localStorage.getItem("cart"))&&(r=JSON.parse(a),c=r.filter((function(t){return t.productId!==e})),localStorage.setItem("cart",JSON.stringify(c)),l=c.reduce((function(t,e){return t+e.sellingPrice*e.quantity}),0),s(c),v((function(t){return S(S({},t),{},{subTotal:l})}))),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),z=function(){var t=(0,c.Z)(n().mark((function t(e,a){var r,c,l,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!I){t.next=16;break}return t.prev=1,D(!0),t.next=5,C({variables:{input:{productId:e,quantity:a}}});case 5:t.sent&&J(),D(!1),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),console.log(t.t0),D(!1);case 14:t.next=18;break;case 16:null!==(r=localStorage.getItem("cart"))&&(c=JSON.parse(r),l=c.map((function(t){return t.productId===e?S(S({},t),{},{quantity:a}):t})),localStorage.setItem("cart",JSON.stringify(l)),o=l.reduce((function(t,e){return t+e.sellingPrice*e.quantity}),0),s(l),v((function(t){return S(S({},t),{},{subTotal:o})})));case 18:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,a){return t.apply(this,arguments)}}();return O(u.Fragment,null,O(x.q,null,O("title",null,"Cart | Arab Deals")),O("main",{className:"main"},O("nav",{"aria-label":"breadcrumb",className:"breadcrumb-nav"},O("div",{className:"container"},O("ol",{className:"breadcrumb"},O("li",{className:"breadcrumb-item"},O(p.Z,{href:"/"},O(b.QO$,{style:{fontSize:"16px"}}))),O("li",{className:"breadcrumb-item active","aria-current":"page"},O(p.Z,{className:"activeitem",href:"/pages/cart"},"Shopping cart"))))),O("div",{className:" d-flex flex-column align-items-center"},O("ul",{className:"checkout-progress-bar d-flex justify-content-center flex-wrap",style:{backgroundColor:"#F9F9F9",width:"100%"}},O("li",{className:"active"},O(p.Z,{href:"/pages/cart"},"Shopping cart")),O("li",{className:""},O(p.Z,{href:"/pages/checkout"},"checkout")),O("li",{className:""},O(p.Z,{href:"/pages/checkout"},"Order Complete")))),O("div",{className:"container",style:{marginTop:"70px"}},0===(null===l||void 0===l?void 0:l.length)?O("div",{className:"cart-table-container"},O("div",{className:"table table-cart"},O("div",{className:"cart-empty-page text-center"},O("i",{className:"icon-bag-2"}),O("p",null,"No products added to the cart"),O(p.Z,{href:"/shop",className:"btn btn-dark btn-add-cart product-type-simple btn-shop font1"},"return to shop")))):O("div",{className:"row"},O("div",{className:"col-lg-8"},O("div",{className:"cart-table-container"},O("table",{className:"table table-cart"},O("thead",null,O("tr",null,O("th",{className:"thumbnail-col"},"Product"),O("th",{className:"product-col pl-0"}),O("th",{className:"price-col"},"Price"),O("th",{className:"qty-col"},"Quantity"),O("th",{className:"text-right"},"Subtotal"))),O("tbody",null,null===l||void 0===l?void 0:l.map((function(t,e){return O("tr",{key:"cart-item"+e,className:"product-row",style:{color:"black"}},O("td",{className:"pl-0"},O("figure",{className:"product-image-container"},O(p.Z,{href:"/product/default/".concat(t.productId),className:"product-image"},O("img",{src:null===t||void 0===t?void 0:t.image,alt:"product"})),O("div",{title:"Remove Product",style:{width:"20px",height:"20px",position:"absolute",top:"-7px",display:"flex",justifyContent:"center",alignItems:"center",right:"-5px",borderRadius:"50%",filter:"drop-shadow(1px 1px 6px rgba(0, 0, 0, 0.11))"},className:"hoverinto",onClick:function(a){a.preventDefault(),M(t.productId,e)}},O(g.oHP,{style:{fontSize:"10px"}})))),O("td",{className:"product-col"},O("h5",{className:"product-title"},O(p.Z,{href:"/product/default/".concat(null===t||void 0===t?void 0:t.productId)},t.name))),O("td",null,"OMR ",t.sellingPrice.toFixed(2)),O("td",null,O(m.Z,{disabled:E,value:null===t||void 0===t?void 0:t.quantity,max:(null===t||void 0===t?void 0:t.stock)<10?null===t||void 0===t?void 0:t.stock:10,onChangeQty:function(e){return z(null===t||void 0===t?void 0:t.productId,e)}})),O("td",{className:"text-right"},O("span",{className:"subtotal-price"},"OMR"," ",(Number(t.sellingPrice)*Number(t.quantity)).toFixed(2))))}))),O("tfoot",null)))),O("div",{className:"col-lg-4"},O("div",{className:"cart-summary"},O("h3",null,"Cart Totals"),O("table",{className:"table table-totals"},O("tbody",null,I&&O("tr",null,O("td",null,"Shipping Charge"),O("td",{style:{color:"black"}},"OMR ",f.deliveryCharge)),O("tr",null,O("td",null,"Subtotal"),O("td",{style:{color:"black"}},"OMR ",null===(e=f.subTotal)||void 0===e?void 0:e.toFixed(2)))),O("tfoot",null,I&&O("tr",null,O("td",null,"Total"),O("td",null,"OMR ",parseFloat(f.grandTotal).toFixed(2))))),O("div",{className:"checkout-methods"},O("div",{href:"checkout",className:"btn btn-block btn-dark hoverbtn",onClick:function(){I?a.push("/pages/checkout"):a.push("/pages/login?origin=pages-cart")}},"Proceed to Checkout")))))),O("div",{className:"mb-6"})))})))},714:function(t,e,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pages/cart",function(){return a(4140)}])}},function(t){t.O(0,[9774,2888,179],(function(){return e=714,t(t.s=e);var e}));var e=t.O();_N_E=e}]);