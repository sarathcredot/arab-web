(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3065],{9592:function(e,n,t){"use strict";var r=t(809),i=t.n(r),s=t(6265),l=t(2447),a=t(4121),o=t(7261),d=t(7294),u=t(2439),c=t(2559),p=t(9710),m=t(4931),v=t(1919),g=t(2132),f=t(1163),h=(t(8974),t(1649)),b=d.createElement;function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function C(){var e=(0,o.Z)(["mutation EditUserShippingAddress($input: UserEditShippingAddressInput!) {\n    editUserShippingAddress(input: $input) {\n      _id\n    }\n  }"]);return C=function(){return e},e}function S(){var e=(0,o.Z)(["query GetUserShippingAddress($input: GetUserShippingAddressInput!) {\n    getUserShippingAddress(input: $input) {\n      _id\n      apartment\n      city\n      \n      country\n      email\n      firstname\n      houseNumber\n      mobile\n      postCode\n      streetName\n      suite\n      unit\n     \n    }\n  }"]);return S=function(){return e},e}function x(){var e=(0,o.Z)(["mutation CreateUserShippingAddress($input: UserCreateShippingAddressInput!) {\n    createUserShippingAddress(input: $input) {\n      _id\n    }\n  }"]);return x=function(){return e},e}var k=(0,p.Ps)(x()),A=(0,p.Ps)(S()),U=(0,p.Ps)(C());n.ZP=(0,c.Z)({ssr:!1})((function(e){var n,t,r,s,o,c,p=e.isEdit,y=e.addressId,C=e.onClose,S=e.isShipping,x=e.onIsShipping,O=((0,f.useRouter)(),(0,m.a)(A,{variables:{input:{_id:y}}})),w=O.data,_=(O.loading,O.error,(0,u.cI)({defaultValues:{firstname:"",country:"",streetName:"",houseNumber:"",city:"",postCode:"",apartment:"",email:"",mobile:""}})),E=(_.register,_.handleSubmit),P=(_.watch,_.setValue),q=_.reset,I=_.formState.errors,Z=_.control;(0,d.useEffect)((function(){var e,n,t,r,i,s,l,a,o;p&&(P("firstname",null===w||void 0===w||null===(e=w.getUserShippingAddress)||void 0===e?void 0:e.firstname),P("country",null===w||void 0===w||null===(n=w.getUserShippingAddress)||void 0===n?void 0:n.country),P("houseNumber",null===w||void 0===w||null===(t=w.getUserShippingAddress)||void 0===t?void 0:t.houseNumber),P("streetName",null===w||void 0===w||null===(r=w.getUserShippingAddress)||void 0===r?void 0:r.streetName),P("city",null===w||void 0===w||null===(i=w.getUserShippingAddress)||void 0===i?void 0:i.city),P("postCode",null===w||void 0===w||null===(s=w.getUserShippingAddress)||void 0===s?void 0:s.postCode),P("mobile",null===w||void 0===w||null===(l=w.getUserShippingAddress)||void 0===l?void 0:l.mobile),P("email",null===w||void 0===w||null===(a=w.getUserShippingAddress)||void 0===a?void 0:a.email),P("apartment",null===w||void 0===w||null===(o=w.getUserShippingAddress)||void 0===o?void 0:o.apartment))}),[p,w]);var D=(0,v.D)(k),R=(0,a.Z)(D,1)[0],T=(0,v.D)(U),j=(0,a.Z)(T,1)[0],$=function(){var e=(0,l.Z)(i().mark((function e(n){var t,r,s,l,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(event.preventDefault(),e.prev=1,!p){e.next=9;break}return e.next=5,j({variables:{input:N({_id:null===w||void 0===w||null===(t=w.getUserShippingAddress)||void 0===t?void 0:t._id},n)}});case 5:e.sent&&(g.Am.success(b("div",{style:{padding:"10px"}},"Shipping address updated")),C()),e.next=13;break;case 9:return e.next=11,R({variables:{input:N({},n)}});case 11:(r=e.sent)&&(null===(s=localStorage)||void 0===s||s.setItem("shippingId",null===r||void 0===r||null===(l=r.data)||void 0===l||null===(a=l.createUserShippingAddress)||void 0===a?void 0:a._id),(0,g.Am)(b("div",{style:{padding:"10px"}},"Shipping address added")),C(),q());case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),(0,g.Am)(b("div",{style:{padding:"10px"}},e.t0.message));case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(n){return e.apply(this,arguments)}}(),W={city:{required:"City is required"},firstname:{required:"First Name is required"},houseNumber:{required:"HouseNumber is required"},mobile:{required:"Mobile is required"},postCode:{required:"postCode is required"},streetName:{required:"Street Name is required"},email:{pattern:{value:/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,message:"Invalid email address"}}};return b("div",null,b("div",{className:"container checkout-container"},b("div",{className:"row"},b("div",{className:"col-lg-12"},b("ul",{className:"checkout-steps"},b("li",null,b("div",{className:"container custom-formspace"},b("h4",{className:"step-title",style:{display:"flex",alignItems:"center",gap:"10px"}},b("div",{onClick:function(){return x(!S)},className:{width:"40px",height:"40px",backgroundColor:"rgba(232, 232, 232, 0.29)",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"}},b(h.UkU,{style:{fontSize:"20px"}})),"Shipping address")),b("form",{onSubmit:E($),id:"checkout-form",style:{marginTop:"40px"}},b("div",{className:"form-group"},b("label",{style:{fontFamily:"Poppins",fontWeight:"400px",lineHeight:"20px"}},"First name"," ",b("ab",{className:"required",title:"required"},"*")),b(u.Qr,{control:Z,name:"firstname",render:function(e){var n=e.field,t=n.onChange,r=n.value;return b("input",{type:"text",className:"form-control",value:r,onChange:t,style:{marginTop:"10px"}})},rules:W.firstname}),null!==I&&void 0!==I&&I.firstname?b("div",{style:{color:"red",fontWeight:"300"}},null===I||void 0===I||null===(n=I.firstname)||void 0===n?void 0:n.message):null),b("div",{className:"form-group"},b("label",{style:{fontFamily:"Poppins",fontWeight:"400px",lineHeight:"20px"}},"Country / Region "," "),b(u.Qr,{control:Z,name:"country",render:function(e){var n=e.field,t=n.onChange,r=n.value;return b("input",{type:"text",className:"form-control",value:r,onChange:t,style:{marginTop:"10px"}})}})),b("div",{className:"form-group"},b("label",null,"Street address ",b("span",{className:"required"},"*")),b(u.Qr,{control:Z,name:"houseNumber",render:function(e){var n=e.field,t=n.onChange,r=n.value;return b("input",{type:"text",className:"form-control",placeholder:"House number and street name",value:r,onChange:t,style:{marginTop:"10px"}})},rules:W.houseNumber}),null!==I&&void 0!==I&&I.houseNumber?b("div",{style:{color:"red",fontWeight:"300"}},null===I||void 0===I||null===(t=I.houseNumber)||void 0===t?void 0:t.message):null,b(u.Qr,{control:Z,name:"streetName",render:function(e){var n=e.field,t=n.onChange,r=n.value;return b("input",{type:"text",className:"form-control",placeholder:"Apartment, suite, unit, etc. (optional)",value:r,onChange:t})},rules:W.streetName}),null!==I&&void 0!==I&&I.streetName?b("div",{style:{color:"red",fontWeight:"300"}},null===I||void 0===I||null===(r=I.streetName)||void 0===r?void 0:r.message):null),b("div",{className:"form-group"},b("label",null,"Twon/City ",b("span",{className:"required"},"*")),b(u.Qr,{control:Z,name:"city",render:function(e){var n=e.field,t=n.onChange,r=n.value;return b("input",{type:"text",className:"form-control",placeholder:"Abu Dhabi",value:r,onChange:t,style:{marginTop:"10px"}})},rules:W.city}),null!==I&&void 0!==I&&I.city?b("div",{style:{color:"red",fontWeight:"300"}},null===I||void 0===I||null===(s=I.city)||void 0===s?void 0:s.message):null),b("div",{className:"form-group"},b("label",null,"Pincode/Zip ",b("span",{className:"required"},"*")),b(u.Qr,{control:Z,name:"postCode",render:function(e){var n=e.field,t=n.onChange,r=n.value;return b("input",{type:"number",className:"form-control",placeholder:"6730016",value:r,onChange:t,style:{marginTop:"10px"}})},rules:W.postCode}),null!==I&&void 0!==I&&I.postCode?b("div",{style:{color:"red",fontWeight:"300"}},null===I||void 0===I||null===(o=I.postCode)||void 0===o?void 0:o.message):null),b("div",{className:"form-group"},b("label",null,"Phone",b("span",{className:"required"},"*")),b("div",{className:"input-group",style:{marginTop:"10px"}},b("div",{className:"input-group-prepend"},b("span",{className:"input-group-text",style:{padding:"10px"}},b("img",{src:"images\\brands\\flag1.svg",alt:"Flag",width:"24",height:"16"}),"+971")),b(u.Qr,{control:Z,name:"mobile",render:function(e){var n=e.field,t=n.onChange,r=n.value;return b("input",{type:"tel",className:"form-control",placeholder:"Enter your phone number",value:r,onChange:t})},rules:W.mobile})),null!==I&&void 0!==I&&I.mobile?b("div",{style:{color:"red",fontWeight:"300"}},null===I||void 0===I||null===(c=I.city)||void 0===c?void 0:c.mobile):null),b("div",{className:"form-group"},b("label",null,"Email"),b(u.Qr,{control:Z,name:"email",render:function(e){var n=e.field,t=n.onChange,r=n.value;return b("input",{type:"text",className:"form-control",value:r,onChange:t,style:{marginTop:"10px"}})}})),b("div",{className:"container",style:{display:"flex",justifyContent:"flex-end"}},b("div",{className:"mt-3"},b("button",{type:"submit",className:"btn btn-dark mr-0"},"Save changes"))))))))))}))},2774:function(e,n,t){"use strict";t.r(n),t.d(n,{GET_ADDRESSES:function(){return A},REMOVE_ADDRESS:function(){return U},PLACE_ORDER:function(){return O}});var r=t(809),i=t.n(r),s=t(2447),l=(t(6265),t(4121)),a=t(7261),o=t(7294),d=t(8216),u=(t(2954),t(8974)),c=t(9710),p=t(4931),m=t(1919),v=t(2559),g=t(9592),f=t(155),h=(t(2132),t(1163)),b=t(4593),y=o.createElement;function N(){var e=(0,a.Z)(["\n  mutation CreateUserOrder($input: CreateUserOrderInput!) {\n    createUserOrder(input: $input) {\n      orderId\n    }\n  }\n"]);return N=function(){return e},e}function C(){var e=(0,a.Z)(["\n  mutation RemoveUserShippingAddress($input: UserRemoveShippingAddressInput!) {\n    removeUserShippingAddress(input: $input) {\n      _id\n      message\n    }\n  }\n"]);return C=function(){return e},e}function S(){var e=(0,a.Z)(["\n  query GetUserShippingAddresses {\n    getUserShippingAddresses {\n      address {\n        _id\n        apartment\n        city\n\n        country\n        email\n        firstname\n        houseNumber\n        mobile\n        postCode\n        streetName\n        suite\n        unit\n        isDefault\n      }\n    }\n  }\n"]);return S=function(){return e},e}function x(){var e=(0,a.Z)(["\n  query GetCart {\n    getCart {\n      products {\n        _id\n        productId\n        quantity\n        name\n        stock\n        sellingPrice\n        price\n        image\n      }\n      grandTotal\n      subTotal\n      deliveryCharge\n    }\n  }\n"]);return x=function(){return e},e}var k=(0,c.Ps)(x()),A=(0,c.Ps)(S()),U=(0,c.Ps)(C()),O=(0,c.Ps)(N());n.default=(0,v.Z)({ssr:!1})((0,d.$j)((function(e){return{cartList:e.cartlist.cart?e.cartlist.cart:[]}}))((function(){var e,n,t,r,a,d=localStorage.getItem("arabtoken"),c=(0,o.useState)(),v=c[0],N=c[1],C=(0,o.useState)(!1),S=C[0],x=C[1],w=(0,o.useState)(!1),_=w[0],E=w[1],P=(0,o.useState)(""),q=P[0],I=P[1],Z=(0,o.useState)(null),D=Z[0],R=Z[1],T=(0,p.a)(A),j=T.data,$=(T.loading,T.error,T.refetch),W=(0,m.D)(U),F=(0,l.Z)(W,1)[0],Q=(0,m.D)(O),M=(0,l.Z)(Q,1)[0],G=(0,h.useRouter)(),H=(0,o.useState)(!1),z=(H[0],H[1],localStorage.getItem("arabtoken")),L=(0,p.a)(k,{skip:!z}),V=L.data,X=(L.loading,L.error),B=L.refetch;(0,o.useEffect)((function(){if(j&&j.getUserShippingAddresses&&j.getUserShippingAddresses.address.length>0){var e=j.getUserShippingAddresses.address.find((function(e){return e.isDefault}));e&&I(e._id)}}),[j]),(0,o.useEffect)((function(){X?console.error("Error fetching cart data:",X):V&&N(V.getCart.products||[]),B()}),[V]);var Y=function(){var e=(0,s.Z)(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F({variables:{input:{_id:n}}});case 2:e.sent,$();case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),J=function(){var e=(0,s.Z)(i().mark((function e(){var n,t,r,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({variables:{input:{grandTotal:null===V||void 0===V||null===(n=V.getCart)||void 0===n?void 0:n.grandTotal,paymentMode:"COD",shippingAddressId:q}}});case 3:s=e.sent,G.push({pathname:"/pages/success",query:{orderId:null===s||void 0===s||null===(t=s.data)||void 0===t||null===(r=t.createUserOrder)||void 0===r?void 0:r.orderId}}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),G.push("/pages/failed");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){d||G.push("/pages/login")}),[]),y(o.Fragment,null,y(b.q,null,y("title",null,"Checkout | Arab Deals")),y("ul",{className:"checkout-progress-bar d-flex justify-content-center flex-wrap"},y("li",null,y(u.Z,{href:"/pages/cart"},"Shopping Cart")),y("li",{className:"active"},y(u.Z,{href:"/pages/checkout"},"Checkout")),y("li",{className:"disabled"},y(u.Z,{href:"#"},"Order Complete"))),y("main",{className:"main main-test"},S?y(o.Fragment,null,y(g.ZP,{isEdit:_,addressId:D,onClose:function(){x(!1),$()},isShipping:S,onIsShipping:x})):y("div",{className:"container checkout-container"},0===(null===v||void 0===v?void 0:v.length)?y("div",{className:"cart-empty-page text-center"},y("p",{className:"noproduct-msg mb-2"},"Checkout is not available while your cart is empty."),y("i",{className:"icon-bag-2"}),y("p",null,"No products added to the cart"),y(u.Z,{href:"/shop",className:"btn btn-dark btn-add-cart product-type-simple btn-shop font1"},"return to shop")):y(o.Fragment,null,y("div",{className:"row",style:{marginTop:"62px"}},y("div",{className:"col-lg-7"},y("div",null,y("h2",{className:"step-title"},"Select a shipping address"),y("div",{className:"shipingBox"},j&&(null===j||void 0===j||null===(e=j.getUserShippingAddresses)||void 0===e?void 0:e.address.length)>0?null===j||void 0===j||null===(n=j.getUserShippingAddresses)||void 0===n?void 0:n.address.map((function(e,n){var t;return y(o.Fragment,null,y("div",{key:n,style:{lineHeight:"19px",alignItems:"baseline",gap:"20px",border:"1px solid #dfdfdf",margin:"15px 0",padding:"10px",borderRadius:"4px"}},y("div",null,y("div",{className:"custom-control custom-radio d-flex"},y("input",{type:"radio",className:"custom-control-input",id:"shipaddress".concat(n),value:e._id,checked:q===e._id,onChange:function(){return n=e._id,void I(n);var n}}),y("label",{className:"custom-control-label",style:{paddingLeft:"10px",maxWidth:"575px"},htmlFor:"shipaddress".concat(n)},null===e||void 0===e?void 0:e.firstname,", \xa0",null===e||void 0===e?void 0:e.houseNumber,","," ",null===e||void 0===e?void 0:e.streetName,", \xa0",null===e||void 0===e?void 0:e.postCode,",",null===e||void 0===e?void 0:e.city,", ",null===e||void 0===e?void 0:e.country))),y("div",{style:{display:"flex",color:"black",width:"100%",alignItems:"flex-end",justifyContent:"flex-end"}},y("div",{className:" btn-address-edit",onClick:function(){x(!0),E(!0),R(null===e||void 0===e?void 0:e._id)}},"Edit"),j&&(null===j||void 0===j||null===(t=j.getUserShippingAddresses)||void 0===t?void 0:t.address.length)>1&&y("button",{style:{cursor:"pointer",background:"none",border:"none",color:"#E30613"},onClick:function(){return Y(null===e||void 0===e?void 0:e._id)}},"Remove"))))})):"",y("div",{style:{display:"flex",gap:"15px",alignItems:"center",cursor:"pointer"},onClick:function(){x(!0)}},y(f.RWZ,{style:{fontSize:"20px"}}),y("p",{className:"addaddressbtn",style:{margin:0}}," ","Add Address"," "))))),y("div",{className:"col-lg-5"},y("div",{className:"order-box"},y("div",{className:"order-summary"},y("h3",null,"YOUR ORDER"),y("table",{className:"table table-mini-cart"},y("thead",null,y("tr",null,y("th",{colSpan:"2",style:{fontSize:"1.4rem",fontWeight:"600"}},"Product"))),y("tbody",null,null===v||void 0===v?void 0:v.map((function(e,n){return y("tr",{key:"checks"+n},y("td",{className:"product-col"},y("h2",{className:"product-title"},(null===e||void 0===e?void 0:e.name)+" \xd7 "+(null===e||void 0===e?void 0:e.quantity))),y("td",{className:"price-col"},y("span",null,"OMR ",(null===e||void 0===e?void 0:e.sellingPrice)*(null===e||void 0===e?void 0:e.quantity))))}))),y("tfoot",null,y("tr",{className:"cart-subtotal"},y("td",null,y("h4",null,"Subtotal")),y("td",{className:"price-col"},y("span",null,"OMR ",null===V||void 0===V||null===(t=V.getCart)||void 0===t?void 0:t.subTotal))),y("tr",{className:"cart-subtotal"},y("td",null,y("h4",null,"Shipping Charge")),y("td",{className:"price-col"},y("span",null,"OMR ",null===V||void 0===V||null===(r=V.getCart)||void 0===r?void 0:r.deliveryCharge))),y("tr",{className:"order-total"},y("td",null,y("h4",null,"Total")),y("td",null,y("b",{className:"total-price"},y("span",null,"OMR ",null===V||void 0===V||null===(a=V.getCart)||void 0===a?void 0:a.grandTotal)))))),y("div",{className:"payment-methods"},y("h4",{className:""},"Payment methods"),y("div",{className:"info-box with-icon p-0"},y("div",{className:"custom-control custom-radio d-flex"},y("input",{type:"radio",className:"custom-control-input",name:"radio",defaultChecked:!0}),y("label",{className:"custom-control-label"},"Cash on Delivery")))),y("button",{type:"submit",value:"Place Order",name:"form-control",className:"btn btn-dark btn-place-order hoverbtn",onClick:J},"Place order")))))))))})))},7728:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pages/checkout",function(){return t(2774)}])}},function(e){e.O(0,[260,2439,9774,2888,179],(function(){return n=7728,e(e.s=n);var n}));var n=e.O();_N_E=n}]);